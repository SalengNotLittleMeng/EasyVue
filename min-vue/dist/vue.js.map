{"version":3,"file":"vue.js","sources":["../src/observe/index.js","../src/state.js","../src/init.js","../src/index.js"],"sourcesContent":["class Observe{\r\n    constructor(data){\r\n        // Object.defineProperty只能劫持已经存在的属性\r\n        this.walk(data);\r\n    }\r\n    walk(data){\r\n        //循环对象，对属性依次劫持,重新定义属性\r\n    Object.keys(data).forEach(key=>{\r\n        defineReactive(data,key,data[key])\r\n    })\r\n    }\r\n}\r\nexport function defineReactive(target,key,value){\r\n// 闭包，从外部拿到value\r\n// 如果劫持到的属性依然是一个对象，就应该递归劫持所有属性，深度属性劫持\r\n    observe(value)\r\n    Object.defineProperty(target,key,{\r\n        get(){\r\n            console.log(\"用户取值了\",value)\r\n            return value\r\n        },\r\n        set(newValue){\r\n            if(newValue==value)return\r\n            value=newValue\r\n        }\r\n    })\r\n}\r\nexport function observe(data){\r\n    if(typeof data!='object'||data==null){\r\n        return //只对对象进行劫持\r\n    }\r\n    //判断对象是否被劫持过，需要用一个实例来观测判断\r\n\r\n    return new Observe(data);\r\n}","import {observe} from \"./observe/index\"\r\nexport function initState(vm) {\r\n  const opts = vm.$options;\r\n  if (opts.data) {\r\n    initData(vm);\r\n  }\r\n}\r\nfunction proxy(vm,target,key){\r\n    Object.defineProperty(vm,key,{\r\n        get(){\r\n        return vm[target][key]\r\n        },\r\n        set(newValue){\r\n         vm[target][key]=newValue\r\n        }\r\n    })\r\n}\r\nfunction initData(vm) {\r\n  let { data } = vm.$options;\r\n  data = typeof data == \"function\" ? data.call(vm) : data;\r\n    vm._data=data\r\n  observe(data)\r\n  for(let key in data){\r\n      proxy(vm,'_data',key)\r\n    }\r\n}","// 给Vue增加初始化方法\nimport {initState} from './state'\nexport function initMixin(Vue) {\n  Vue.prototype._init = function (options) {\n    const vm = this;\n    vm.$options = options;\n    initState(vm);\n  };\n}\n\n","import { initMixin } from \"./init\";\nfunction Vue(options) {\n  this._init(options);\n}\n// 扩展了init方法\ninitMixin(Vue);\nexport default Vue;\n"],"names":["Observe","data","walk","Object","keys","forEach","key","defineReactive","target","value","observe","defineProperty","get","console","log","set","newValue","initState","vm","opts","$options","initData","proxy","call","_data","initMixin","Vue","prototype","_init","options"],"mappings":"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"}