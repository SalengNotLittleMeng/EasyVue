{"version":3,"file":"VueRouter.js","sources":["../src/install.js","../src/create-routesMap.js","../src/create-matcher.js","../src/history/base.js","../src/history/history.js","../src/history/hash.js","../src/index.js"],"sourcesContent":["export let Vue;\nexport function install(_Vue) {\n  Vue = _Vue;\n  Vue.mixin({\n    beforeCreate() {\n      // 这里不用原型继承的原因是因为会导致所有的Vue类共享路由\n      if (this.$options.router) {\n        // 根实例上传递了router\n        this._routerRoot = this;\n        this._router = this.$options.router || {};\n      } else {\n        // 所有组件上都增加一个routerRoot的指针指向根实例\n        this._routerRoot = this.$parent?._router;\n      }\n    },\n  });\n  // 劫持$router属性，取$router其实是取了根实例上的router\n  Object.defineProperty(Vue.prototype, \"$router\", {\n    get() {\n      return this._routerRoot._router;\n    },\n  });\n  Vue.component(\"router-link\", {\n    render(h) {\n      return h(\"a\", { class: \"foo\" }, [this.$slots.default]);\n    },\n  });\n  Vue.component(\"router-view\", {\n    render(h) {\n      return h(\"a\", { class: \"foo\" }, [\"hello\"]);\n    },\n  });\n}\n","export default function createRouteMap(routes, pathMap = {}) {\n  // 根据用户选项扁平化信息,将深度子类转化为扁平层级\n  routes.forEach((route) => {\n    addRouteRecord(route, pathMap);\n  });\n  return {\n    pathMap,\n  };\n}\nfunction addRouteRecord(route, pathMap, parentRecord) {\n  let path = parentRecord\n    ? `${parentRecord.path == \"/\" ? \"\" : \"/\"}${route.path}`\n    : route.path;\n  if (!pathMap[path]) {\n    pathMap[path] = {\n      path,\n      component: route.component,\n      props: route.props,\n      meta: route.meta,\n    };\n  }\n  route.children &&\n    route.children.forEach((children) => {\n      addRouteRecord(children, pathMap);\n    });\n}\n","import createRouteMap from \"./create-routesMap\";\nexport default function createMatcher(routes) {\n  let { pathMap } = createRouteMap(routes);\n  function addRoutes(routes) {\n    // 动态添加路由\n    createRouteMap(routes, pathMap);\n  }\n  function addRoute(route) {\n    createRouteMap([route], pathMap);\n  }\n  function match(location) {\n    return pathMap[location];\n  }\n  return {\n    addRoutes, //添加多个路由\n    addRoute, //添加一个路由\n    match, //给一个路径来返回路由\n  };\n}\n","export default class Base {\n  constructor(router) {}\n}\n","import Base from \"./base\";\nclass History extends Base {\n  constructor(router) {\n    super(router);\n  }\n}\n\nexport default History;\n","import Base from \"./base\";\nfunction ensureSlash() {\n  if (window.location.hash) {\n    return;\n  }\n  window.location.hash = \"/\";\n}\nclass Hash extends Base {\n  constructor(router) {\n    super(router);\n    console.log(\"hello\");\n    // 初始化哈希路由的时候要给定默认的哈希路径\n    ensureSlash();\n  }\n  // 之后需要调用此方法，监控hash值的变化\n  setupListener() {}\n}\nexport default Hash;\n","import { install, Vue } from \"./install\";\nimport createMatcher from \"./create-matcher\";\nimport History from \"./history/history\";\nimport Hash from \"./history/hash\";\nclass VueRouter {\n  constructor(options) {\n    this.install = install;\n    // 对用户传入的路由表进行映射\n    const routes = options.routes;\n    this.matcher = createMatcher(routes);\n    // 根据不用的模式创建不同的路由系统\n    let mode = options.mode || \"hash\";\n    if (mode == \"hash\") {\n      this.history = new Hash();\n    } else if (mode == \"history\") {\n      this.history = new History();\n    }\n  }\n}\nexport default VueRouter;\n"],"names":["Vue","install","_Vue","mixin","beforeCreate","$options","router","_routerRoot","_router","$parent","Object","defineProperty","prototype","get","component","render","h","$slots","createRouteMap","routes","pathMap","forEach","route","addRouteRecord","parentRecord","path","props","meta","children","createMatcher","addRoutes","addRoute","match","location","Base","History","ensureSlash","window","hash","Hash","console","log","VueRouter","options","matcher","mode","history"],"mappings":"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"}